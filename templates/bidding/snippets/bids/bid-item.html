{% load i18n static %}
{% load paraminos %}
{% load humanize %}
{% load tz %}

<div id="t-{{ tender.chrono }}-top">

    <a href="{% url 'bidding_bid_details' bid.id %}"
       class="text-decoration-none text-reset">

        <div class="card-header px-2 py-1">
            <div class="oneline">
                {% if bid.lot.tender.cancelled == True %}
                    <span class="badge bg-danger me-1" data-bs-toggle="tooltip" title="{% trans 'Tender is cancelled' %}">
                        <i class="{{ bicons.cancelled }}"></i>
                        <span>{% trans "CANCELLED" %}</span>
                    </span>
                {% endif %}
                <span class="fw-bold small">{{ bid.caption }}</span>
            </div>
        </div>

        <div class="card-body p-0">

            <div id="bid-{{ bid.id }}-digest" class="p-2">

                <div class="row g-1 my-1">
                    <div class="col-12 col-md-6 text-start">
                        <div>
                            <span data-bs-toggle="tooltip" title="{% trans 'Company' %}: {{ bid.company.name }}">
                                <span>
                                    <img src="{{ bid.company.logo }}" alt="X" 
                                        class="img-fluid rounded rounded-circle" 
                                        style="width: 1.5rem; height: 1.5rem;">
                                </span>
                                <span class="">{{ bid.company.name }}</span>
                            </span>                            
                            
                            {% if bid.duplicated %}
                                <span class="badge bg-warning" data-bs-toggle="tooltip" title="{% trans 'Found other bids on the same Tender/lot using the same company' %}">
                                    <i class="{{ bicons.duplicate }}"></i>
                                    <span>{% trans "DUPLICATED" %}</span>
                                </span>
                            {% endif %}
                        </div>
                        <div class="oneline ms-4 text-secondary">
                            {% if bid.date_submitted %}
                                <span data-bs-toggle="tooltip" title="{% trans 'Date submitted' %}">  
                                    <span class="small"><i class="{{ bicons.bid }} small text-secondary me-1"></i></span>
                                    <span class="small text-secondary me-2 ">{{ bid.date_submitted.date|default:'-' }}</span>                                  
                                </span>
                            {% endif %}
                            <span data-bs-toggle="tooltip" title="{% trans 'Creator' %}">  
                                <span class="fw-light">
                                    <img src="{{ bid.creator.profile.avatar }}" alt="X" 
                                            class="img-fluid rounded rounded-circle" 
                                            style="width: 1rem; height: 1rem;">
                                </span>
                                <span class="small text-secondary">{{ bid.creator }}</span>                              
                            </span>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 text-end">
                        <div data-bs-toggle="tooltip" title="{% trans 'Bid amount' %}"> 
                            <span><i class="{{ bicons.estimate }} small"></i></span>
                            <span class="fw-bold">{{ bid.bid_amount }}</span>
                        </div>
                        <div>
                            <span class="badge bg-{{ bid.tag_tint }}" data-bs-toggle="tooltip" title="{% trans 'Bid status' %}">{{ bid.tag_display }}</span>
                        </div>
                    </div>
                </div>              
            </div>

        </div>

        <div class="card-footer small px-2 py-1">
            <div class="small">

                <span class="me-2 my-0 badge fw-light bg-{{ bid.bond_tint }}" data-bs-toggle="tooltip" title="{% trans 'Bond amount' %}">
                    <span><i class="{{ bicons.bond }}"></i></span>
                    <span class="fw-bold">{{ bid.bond_amount|default:'--' }}</span>
                </span>

                {% if bid.tasks.all %}
                    <span class="me-2 my-0" data-bs-toggle="tooltip" title="{% trans 'Tasks' %}">
                        <span><i class="{{ bicons.task }}"></i></span>
                        <span class="">{{ bid.tasks.all|length }}</span>
                    </span>
                {% endif %}
                
                {% if bid.expenses.all %}
                    <span class="me-2 my-0" data-bs-toggle="tooltip" title="{% trans 'Expenses' %}">
                        <span><i class="{{ bicons.expense }}"></i></span>
                        <span class="">{{ bid.expenses.all|length }}</span>
                    </span>
                {% endif %}

                {% if bid.contracts.all %}
                    <span class="me-2 my-0" data-bs-toggle="tooltip" title="{% trans 'Contracts' %}">
                        <span><i class="{{ bicons.contract }}"></i></span>
                        <span class="">{{ bid.contracts.all|length }}</span>
                    </span>
                {% endif %}

            </div>
        </div>

    </a>

</div>